binom = read.table("table_620tf_100binomp.txt", header=True)
binom = read.table("table_620tf_100binomp.txt", header=TRUE)
binom = read.table("table_620tf_100binomp.txt", header=TRUE)
help(read.table)
binom = read.table("table_100_binomp.txt", header=TRUE)
binom = read.table("table_100_binomp.txt", header=TRUE)
heand(binom)
head(binom)
library(ggplot2)
library(A::)
library(All)
library(ALL)
biocLite("ALL")
source("http://bioconductor.org/biolite.R")
source("http://bioconductor.org/bioLite.R")
source("http://bioconductor.org/bioclite.R")
source("http://bioconductor.org/biocLite.R")
?bioclite
?biocLite
library(ggplot2)
library(ALL)
data("ALL")
biocLite("ALL")
a
data("ALL")
library("ALL")
data("ALL")
library("limma")
version()
eset = ALL[,ALL$mol.biol %in% c("BCR/ABL", "ALL1/AF4")]
head(eset
)
type(eset)
typeof(eset)
f<- factor(as.character(eset$mol.biol))
f
design <- model.matrix(~f)
design
fit <- eBayes(lmFit(eset, design))
fit
selected <- p.adjust(fit$p.value[,2]) <0.01
esetSel <- eset[selected,]
dim(esetSel)
eset<-ALL[,ALL$mol.biol %in% c("BCR/ABL","ALL1/AF4")]
f<-factor(as.character(eset$mol.biol))
design<-model.matrix(~f)
fit<-eBayes(lmFit(eset,design))
selected  <- p.adjust(fit$p.value[, 2]) <0.001 
esetSel <- eset[selected,]
dim(esetSel)
mode(ALL)
ALL$1
ALL$mol.biol
mode(ALL)
typeof(ALL)
 attributes(ALL)
ALL$mol.biol
typeof(ALL$mol.biol)
attributes(ALL$mol.biol)
 ALL$mol.biol[1]
as.integer(eset$mol.biol)
help(mode.matrix)
help(model.matrix)
help(model.matrix)
ls()
objects()
binomp <- read.table(file="table_100_binomp.txt", header = TRUE)
head(binomp)
binomp <- read.table(file="table_100_binomp.txt", header = TRUE)
hyperp <- read.table(file= "table_100_hyperp.txt", header=TRUE)
test <-  head(binomp)
heatmap(test)
typeof(test)
test
help(do.call)
do.call(rbind, test)
matrix <- do.call(rbind, test)
heatmap(matrix)
help(is.na)
is.na(matrix)
matrxi[1,]
matrix[1,]
matrix[2,]
cname(matrix)
colnames(matrix)
?head
matrix <-  haed(binomp, 3)
matrix <-  head(binomp, 3)
matrix
head(binomp)
hyperp
attributes(binomp)
?head
heapmap(do.call(rbind, binomp))
heatmap(do.call(rbind, binomp))
b.matrix <- do.call(rbind, binomp))
b.matrix <- do.call(rbind, binomp)
h.matrix <- do.call(rbind, hyperp)
h.matrix <- do.call(rbind, hyperp)
b.matrix.minus.log <- -log(b.matrix)
b.matrix.minus.log
heatmap(b.matrix.minus.log)
heatmap(b.matrix)
dev.new()
heatmap(h.matrix)
tableEdit
head(b.matrix.minus.log)
nrow(b.matrix.minus.log)
NCOL(b.matrix.minus.log)
nrow(binomp)
?rbind
?rbind
b.matrix <- do.call(cbind, binomp);

h.matrix <- do.call(cbind, hyperp)

heatmap(b.matrix)
b.matrix.minus.log <- -log(b.matrix)
heatmap(b.matrix.minus.log)
write.table(b.matrix.minus.log, file = "minuslog.txt")
colnames(b.matrix.minus.log) <- colnames(binomp)
write.table(b.matrix.minus.log, file = "minuslog.txt")
colnames(b.matrix.minus.log)
rownames(b.matrix.minus.log) <- rownames(binomp)
write.table(b.matrix.minus.log, file = "minuslog.txt")
write.table(b.matrix.minus.log, file = "minuslog.txt",sep="\t")
a <- b.matrix
a <- b.matrix.minus.log
a[is.infinite(a)] = 0
heatmap(a)
binomp <- read.table(file="table_100_binomp.txt", header = TRUE);

hyperp <- read.table(file= "table_100_hyperp.txt", header=TRUE);

b.matrix <- do.call(cbind, binomp);

h.matrix <- do.call(cbind, hyperp)


colnames(b.matrix)
rownames(b.matrix)
rownames(b.matrix) <- rownames(binomp)
rownames(b.matrix)
rownames(b.matrix) <- rownames(binomp)
rownames(h.matrix) <- rownames(hyperp)

heatmap(h.matrix)
t <- c(1,1,2,2,3,4,5)
table(t)
?table
table(h.matrix[11,])
table(h.matrix[20,])
table(h.matrix[50,])
table(h.matrix[1,])
table(h.matrix[100,])
table(h.matrix[1,])
table(h.matrix[,1])
table(h.matrix[,10])
table(h.matrix[,15])
heatmap(b.matrix)
?average
?mean
mean(b.matrix)
mean(b.matrix[!is.na(b.matrix)]))
mean(b.matrix[!is.na(b.matrix)])
b.matrix[is.na(b.matrix)] = mean(b.matrix[!is.na(b.matrix)])
heatmap(b.matrix)
b.matrix.minus.log[is.na(b.matrix.minus.log)] <- mean(b.matrix.minus.log[!is.na(b.matrix.minus.log)])

heatmap(b.matrix.minus.log)
b.matrix.minus.log[is.infinite(b.matrix.minus.log)] <- mean(b.matrix.minus.log[!is.infinite(b.matrix.minus.log)])

heatmap(b.matrix.minus.log)
heatmap(h.matrix.minus.log)
h.matrix.minus.log <- -log(h.matrix);

h.matrix.minus.log[is.infinite(h.matrix.minus.log)] <- mean(h.matrix.minus.log[!is.infinite(h.matrix.minus.log)])

heatmap(h.matrix.minus.log)
h.matrix.minus.log[is.infinite(h.matrix.minus.log)] <- mean(h.matrix.minus.log[!is.infinite(h.matrix.minus.log)])

heatmap(h.matrix.minus.log)
write.table(h.matrix, file = "test.txt", sep = "\t")
getwd()
heatmap(b.matrix.minus.log)
dev.new()
heatmap(h.matrix.minus.log)
write.table(h.matrix.minus.log, file = "test.txt", sep = "\t")
h.matrix.minus.log[h.matrix.minus.log==0] <- mean(h.matrix.minus.log)

heatmap(h.matrix.minus.log)
h.matrix.minus.log[h.matrix.minus.log==0] <- mean(h.matrix.minus.log[!is.na(h.matrix.minus.log)])

heatmap(h.matrix.minus.log)
h.matrix.minus.log <- -log(h.matrix);

h.matrix.minus.log[is.infinite(h.matrix.minus.log)] <- mean(h.matrix.minus.log[!is.infinite(h.matrix.minus.log)])

h.matrix.minus.log[h.matrix.minus.log==0] <- mean(h.matrix.minus.log[!is.infinite(h.matrix.minus.log)])

heatmap(h.matrix.minus.log)
write.table(h.matrix.minus.log, file="test.txt", sep="\t")
h.matrix.minus.log[is.infinite(h.matrix.minus.log)] <- mean(h.matrix.minus.log[!is.infinite(h.matrix.minus.log)])

write.table(h.matrix.minus.log, file="test.txt", sep="\t")
h.matrix.minus.log <- -log(h.matrix);

write.table(h.matrix.minus.log, file="test.txt", sep="\t")
a <- matrix(c(1,2,3,4,5,6),ncol=3)
a
a[1,1] <- Inf
a
is.na(a <- 
is.na(a)
is.infinite(a)
b.matrix.minus.log <- -log(b.matrix);
h.matrix.minus.log <- -log(h.matrix);
b.matrix.minus.log[is.infinite(b.matrix.minus.log)] <- NA;
b.matrix.minus.log[is.nan(b.matrix.minus.log)] <- NA;
b.matrix.minus.log[is.na(b.matrix.minus.log)] <- mean(b.matrix.minus.log[!is.na(b.matrix.minus.log)])
h.matrix.minus.log[is.na(h.matrix.minus.log)] <- mean(h.matrix.minus.log[!is.na(h.matrix.minus.log)])
heatmao(b.matrix.minus.log)
heatmap(b.matrix.minus.log)
heatmap(h.matrix.minus.log)
jpeg("binomial_p_value")
heatmap(b.matrix.minus.log)
dev.off()
postscript("binomial_p_value.ps")
heatmap(b.matrix.minus.log)
dev.off()
heatmap.2
library(gplot)
install.packages("gplot")
install.packages("gplot")
77
install.packages("gplot")
library("gplots")
install.packages("gplots")
ls()
binomp <- read.table(file="table_100_binomp.txt", header = TRUE);

hyperp <- read.table(file= "table_100_hyperp.txt", header=TRUE);

b.matrix <- do.call(cbind, binomp);
rownames(b.matrix) <- rownames(binomp);
h.matrix <- do.call(cbind, hyperp);
rownames(h.matrix) <- rownames(hyperp);


b.matrix.minus.log <- -log(b.matrix);
h.matrix.minus.log <- -log(h.matrix);


b.matrix.minus.log[is.infinite(b.matrix.minus.log)] <- NA;
b.matrix.minus.log[is.nan(b.matrix.minus.log)] <- NA;

b.matrix.minus.log[is.na(b.matrix.minus.log)] <- mean(b.matrix.minus.log[!is.na(b.matrix.minus.log)])
h.matrix.minus.log[is.na(h.matrix.minus.log)] <- mean(h.matrix.minus.log[!is.na(h.matrix.minus.log)])

h.matrix.minus.log[h.matrix.minus.log==0] <- mean(h.matrix.minus.log[!is.infinite(h.matrix.minus.log)])

  


heatmap(h.matrix.minus.log)
4
binomp <- read.table(file="table_100_binomp.txt", header = TRUE);

hyperp <- read.table(file= "table_100_hyperp.txt", header=TRUE);

# Convert the data frames to matrices
b.matrix <- do.call(cbind, binomp);
# Assign the rownames (i.e. the names of the TFs)
rownames(b.matrix) <- rownames(binomp);
# Do the same to hypergeometric p value
h.matrix <- do.call(cbind, hyperp);
rownames(h.matrix) <- rownames(hyperp);

# Though all the GO temrs that I chose are the most common ones,
# some TFs still do not have enrichment in these TFs. As a result,
# in the heatmap of the original p-values, there are a lot of 1s
# and in the heatmap of the minus log p-values, there are a lot
# of Inf's. So I will replace these Inf's with the average of
# the whole matrix.

b.matrix.minus.log <- -log(b.matrix);
h.matrix.minus.log <- -log(h.matrix);


b.matrix.minus.log[is.infinite(b.matrix.minus.log)] <- NA;
b.matrix.minus.log[is.nan(b.matrix.minus.log)] <- NA;

b.matrix.minus.log[is.na(b.matrix.minus.log)] <- mean(b.matrix.minus.log[!is.na(b.matrix.minus.log)]);
h.matrix.minus.log[is.na(h.matrix.minus.log)] <- mean(h.matrix.minus.log[!is.na(h.matrix.minus.log)]);

h.matrix.minus.log[h.matrix.minus.log==0] <- mean(h.matrix.minus.log[!is.infinite(h.matrix.minus.log)])

  


library("
gplots")
library("gplots")
heatmap
heatmap.2(h.matrix.minus.log)
heatmap(matrix(sample(1:10000),nrow=1000,ncol=10))

heatmap.2(h.matrix.minus.log)
pdf("large.pdf", width=20, height=20)
heatmap.2(h.matrix.minus.log)
dev.off()
 library(gplots)
 data(mtcars)
 x  <- as.matrix(mtcars)
 rc <- rainbow(nrow(x), start=0, end=.3)
 cc <- rainbow(ncol(x), start=0, end=.3)

 ##
 ## demonstrate the effect of row and column dendogram options
 ##
 heatmap.2(x)
heatmap.2(h.matrix.minus.log, trace="none")
help(heatmap.2)
heatmap.2(h.matrix.minus.log, trace="none")
dev.new()
heatmap.2(b.matrix.minus.log, trace="none")
pdf("test.pdf", width=10, height=50)
heatmap.2(b.matrix.minus.log, trace="none")
dev.off()
help(layout)
heatmap.2(b.matrix.minus.log, trace="none", lhei=2)
heatmap.2(b.matrix.minus.log, trace="none", lhei=1000)
heatmap.2(b.matrix.minus.log, trace="none", lhei=lcm(1))
heatmap.2(b.matrix.minus.log, trace="none", lhei=1, 100)
heatmap.2(b.matrix.minus.log, trace="none", lhei=c(1,100))
heatmap.2(b.matrix.minus.log, trace="none", lhei=c(1,10))
heatmap.2(b.matrix.minus.log, trace="none", lhei=c(1,5))
heatmap.2(b.matrix.minus.log, trace="none", lhei=c(1,5))
dev.new()
heatmap.2(b.matrix.minus.log, trace="none", lhei=c(1,1))
pdf("large.pdf", width  C-c C-c
?pdf
pdf("large.pdf", width = 7, height=20)
heatmap.2(b.matrix.minus.log, trace="none", lhei=c(1,1))
heatmap.2(b.matrix.minus.log, trace="none", lhei=c(1,1))
dev.off()
pdf("large.pdf", width = 7, height=20)
heatmap.2(b.matrix.minus.log, trace="none", lhei=c(1,5))
dev.off()
pdf("large.pdf", width = 7, height=20)
heatmap.2(b.matrix.minus.log, trace="none", lhei=c(1,10))
dev.off()
pdf("large.pdf", width = 7, height=20)
heatmap.2(b.matrix.minus.log, trace="none", lhei=c(1,20))
heatmap.2(b.matrix.minus.log, trace="none", lhei=c(1,15))
dev.off()
?heatmap.2
pdf("large.pdf", width = 7, height=20)
heatmap.2(b.matrix.minus.log, trace="none", lhei=c(1,15), cexRow = 0.1)
dev.off(0
)
dev.off()
pdf("large.pdf", width = 7, height=20)
heatmap.2(b.matrix.minus.log, trace="none", lhei=c(1,15), cexRow = 0.4)
dev.off()
pdf("large.pdf", width = 7, height=20)
heatmap.2(b.matrix.minus.log, trace="none", lhei=c(1,15), cexRow = 0.3)
dev.off()
pdf("large.pdf", width = 7, height=20)
heatmap.2(b.matrix.minus.log, trace="none", lhei=c(1,15), cexRow = 0.25)
dev.off()
